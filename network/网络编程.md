# TCP/IP网络编程

## 套接字Socket

套接字是一种通信机制，凭借这种机制，客户/服务器系统的开发工作既可以在本地单机上进行，也可以跨网络进行，Linux所提供的功能（如打印服务，ftp等）通常都是通过套接字来进行通信的。



## 套接字编程

网络编程创建连接请求的套接字过程：

1. 调用socket函数创建套接字

   > #include <sys/socket.h>
   >
   > int socket(int domain, int type, int protocol);
   >
   > domain-协议族               一般为PF_INET，代表IPv4互联网协议族
   >
   >  type-数据传输方式        SOCK_STREAM代表面向连接的套接字，对应TCP   
   >
   > ​										 SOCK_DGRAM代表面向消息的套接字，对应UDP
   >
   >  protocol-通信协议		一般设为0，表示选择当前family和type组合下的protocol
   >
   >  
   >
   > 成功返回文件描述符，失败时返回1



2. 调用bind函数分配IP地址和端口号

   > int bind(int sockfd,  struct sockaddr* myaddr, socklen_t addrlen);
   >
   > sockfd-套接字文件描述符
   >
   > myaddr-指向特定协议的地址结构的指针
   >
   > addrlen-该地址结构的长度
   >
   >  
   >
   > 成功返回0，失败返回-1



3. 调用listen函数转为可接收请求状态

   > int listen(int sockfd, int backlog);
   >
   > sockfd-套接字文件描述符
   >
   > backlog-连接请求等待队列的长度
   >
   >  
   >
   > 成功时返回0，失败时返回-1

 

4. 调用accept函数受理连接请求

   >  int accept(int sockfd, struct sockaddr* addr, socklent_t* addrlen);
   >
   > sockfd-套接字文件描述符
   >
   > addr-指向客户端地址结构体的指针
   >
   > addrlen-addr结构体的长度
   >
   >  
   >
   > 成功返回**创建的套接字文件描述符**，失败时返回-1

   